!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.MiniModal=t()}(this,function(){"use strict";var e,t={modalOverlay:".mini-modal__overlay",modalContent:".mini-modal__content",modalCloseBtn:".mini-modal__close",bodyOpenClass:"mini-modal--open",modalOpenClass:"open",backgroundClickClose:!0,escClose:!0,openImmediately:!0,moveToBodyEnd:!0},s=document.body,n=function(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]=arguments[e][t]);return arguments[0]},i=function(e,t){var s=e.className.split(" "),n=s.indexOf(t);n>-1&&s.splice(n,1),e.className=s.join(" ")},o=function(){this.modalCloseBtn.addEventListener("click",this.close),this.settings.escClose&&s.addEventListener("keyup",this._escCloseHandler),this.settings.backgroundClickClose&&this.modalOverlay.addEventListener("click",this.close)},l=function(){this.modalCloseBtn.removeEventListener("click",this.close),this.modalOverlay.removeEventListener("click",this.close),s.removeEventListener("keyup",this._escCloseHandler)},a=function(){this.onBeforeClose(this.modal),i(this.modal,this.settings.modalOpenClass),i(s,this.settings.bodyOpenClass),this._unbindClose()},d=function(e){27===e.keyCode&&this.close(),e.preventDefault()},h=function(){},r=function(){},m=function(){},c=function(e,i){return this.settings=n({},t,i||{}),this.modal=document.getElementById(e),this.modal?(this.modalOverlay=this.modal.querySelector(this.settings.modalOverlay),this.modalContent=this.modal.querySelector(this.settings.modalContent),this.modalCloseBtn=this.modal.querySelector(this.settings.modalCloseBtn),this.onInit=this.settings.onInit||h,this.onBeforeOpen=this.settings.onBeforeOpen||r,this.onBeforeClose=this.settings.onBeforeClose||m,this.close=a.bind(this),this._escCloseHandler=d.bind(this),this._bindClose=o.bind(this),this._unbindClose=l.bind(this),this.onInit.apply(this),this.settings.moveToBodyEnd&&s.appendChild(this.modal),void(this.settings.openImmediately&&this.open())):{error:'Element with id "'+e+'" not found.'}};return c.prototype.open=function(){this._bindClose(),setTimeout(function(){this.onBeforeOpen(this.modal),s.className+=" "+this.settings.bodyOpenClass,this.modal.className+=" "+this.settings.modalOpenClass,e=this}.bind(this),10)},c.close=function(){e&&e.close(),e=null},c.open=function(e,t){return c.close(),n(t||{},{openImmediately:!0}),new c(e,t)},c.getActiveModal=function(){return e},c});