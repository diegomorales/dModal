!function(e,o){"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?module.exports=o():e.MiniModal=o()}(this,function(){"use strict";var e,o={},n={modalOverlay:".mini-modal__overlay",modalContent:".mini-modal__content",modalCloseBtn:".mini-modal__close",bodyOpenClass:"mini-modal-active",modalOpenClass:"open",backgroundClickClose:!0,escClose:!0,openImmediately:!1,moveToBodyEnd:!0,onInit:function(){},onBeforeOpen:function(){},onBeforeClose:function(){}},l=document,t=l.documentElement.classList?function(e,o){e.classList.remove(o)}:function(e,o){var n=e.className.split(" "),l=n.indexOf(o);l>-1&&n.splice(l,1),e.className=n.join(" ")},a=function(){for(var e=1;e<arguments.length;e++)for(var o in arguments[e])arguments[e].hasOwnProperty(o)&&(arguments[0][o]=arguments[e][o]);return arguments[0]};return o.create=function(d,i){var s=a({},n,i),c={};if(!(c.modal=document.getElementById(d)))throw new Error('Element with id "'+d+'" not found.');c.modalOverlay=c.modal.querySelector(s.modalOverlay),c.modalContent=c.modal.querySelector(s.modalContent),c.modalCloseBtn=c.modal.querySelector(s.modalCloseBtn);var r=function(){c.modalCloseBtn.addEventListener("click",c.close),s.escClose&&l.body.addEventListener("keyup",u),s.backgroundClickClose&&c.modalOverlay.addEventListener("click",c.close)},m=function(){c.modalCloseBtn.removeEventListener("click",c.close),c.modalOverlay.removeEventListener("click",c.close),l.body.removeEventListener("keyup",u)},u=function(e){27===e.keyCode&&c.close(),e.preventDefault()};return c.open=function(){o.close(),r(),setTimeout(function(){s.onBeforeOpen(c),l.body.className+=" "+s.bodyOpenClass,c.modal.className+=" "+s.modalOpenClass,e=c},10)},c.close=function(){s.onBeforeClose(c)!==!1&&(t(c.modal,s.modalOpenClass),t(l.body,s.bodyOpenClass),m(),e=null)},s.onInit(c),s.moveToBodyEnd&&l.body.appendChild(c.modal),s.openImmediately&&c.open(),c},o.close=function(){e&&e.close(),e=null},o.open=function(e,n){return o.close(),o.create(e,a(n||{},{openImmediately:!0}))},o.getActiveModal=function(){return e},o});