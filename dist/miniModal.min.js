!function(e,o){"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?module.exports=o():e.MiniModal=o()}(this,function(){"use strict";var e,o={},n={modalOverlayClass:"mini-modal__overlay",modalContentClass:"mini-modal__content",modalCloseBtnClass:"mini-modal__close",bodyOpenClass:"mini-modal-active",modalOpenClass:"mini-modal--open",backgroundClickClose:!0,escClose:!0,openImmediately:!1,moveToBodyEnd:!0,onInit:function(){},onBeforeOpen:function(){},onBeforeClose:function(){}},l={modalOverlay:"[data-mini-modal-overlay]",modalContent:"[data-mini-modal-content]",modalCloseBtn:"[data-mini-modal-close]"},t=document,a=t.documentElement.classList?function(e,o){e.classList.add(o)}:function(e,o){e.className+=" "+o},d=t.documentElement.classList?function(e,o){e.classList.remove(o)}:function(e,o){var n=e.className.split(" "),l=n.indexOf(o);l>-1&&n.splice(l,1),e.className=n.join(" ")},s=function(){for(var e=1;e<arguments.length;e++)for(var o in arguments[e])arguments[e].hasOwnProperty(o)&&(arguments[0][o]=arguments[e][o]);return arguments[0]};return o.create=function(i,c){var m=s({},n,c),r={};if(!(r.modal=document.getElementById(i)))throw new Error('Element with id "'+i+'" not found.');r.modalOverlay=r.modal.querySelector(l.modalOverlay),r.modalContent=r.modal.querySelector(l.modalContent),r.modalCloseBtn=r.modal.querySelector(l.modalCloseBtn),a(r.modalOverlay,m.modalOverlayClass),a(r.modalContent,m.modalContentClass),a(r.modalCloseBtn,m.modalCloseBtnClass);var u=function(){r.modalCloseBtn.addEventListener("click",y),m.escClose&&t.body.addEventListener("keyup",C),m.backgroundClickClose&&r.modalOverlay.addEventListener("click",y)},f=function(){r.modalCloseBtn.removeEventListener("click",y),r.modalOverlay.removeEventListener("click",y),t.body.removeEventListener("keyup",C)},C=function(e){27===e.keyCode&&y(),e.preventDefault()},v=function(){o.close(),u(),setTimeout(function(){m.onBeforeOpen.call(null,r),a(t.body,m.bodyOpenClass),a(r.modal,m.modalOpenClass),e=r},10)},y=function(){arguments[0]&&arguments[0].preventDefault&&arguments[0].preventDefault(),m.onBeforeClose.call(null,r)!==!1&&(d(r.modal,m.modalOpenClass),d(t.body,m.bodyOpenClass),f(),e=null)},p=function(e){switch(e){case"onInit":m.onInit.call(null,r);break;case"onBeforeOpen":m.onBeforeOpen.call(null,r);break;case"onBeforeClose":m.onBeforeClose.call(null,r)}};return m.onInit.call(null,r),m.moveToBodyEnd&&t.body.appendChild(r.modal),m.openImmediately&&v(),r.open=v,r.close=y,r._trigger=p,r._bindClose=u,r._unbindClose=f,r},o.close=function(){e&&e.close(),e=null},o.open=function(e,n){return o.close(),o.create(e,s(n||{},{openImmediately:!0}))},o.getActiveModal=function(){return e},o});