!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.minimodal=t()}(this,function(){"use strict";function e(e){return this.settings=i({},e,n),this.modal=document.getElementById(e.modalId),this.modalOverlay=this.modal.querySelector(this.settings.modalOverlay),this.modalContent=this.modal.querySelector(this.settings.modalContent),this.modalCloseBtn=this.modal.querySelector(this.settings.modalCloseBtn),this.onInit=e.onInit||h,this.onBeforeOpen=e.onBeforeOpen||c,this.onBeforeClose=e.onBeforeClose||u,this.close=r.bind(this),this._escCloseHandler=m.bind(this),this._bindClose=a.bind(this),this._unbindClose=d.bind(this),this.modal?(this.onInit.apply(this),o.appendChild(this.modal),void(this.settings.openImmediately&&this.open())):{error:'modal dialog with id "'+e.modalId+'" not found.'}}var t,s={},n={modalOverlay:".mini-modal__overlay",modalContent:".mini-modal__content",modalCloseBtn:".mini-modal__close",bodyOpenClass:"mini-modal--open",modalOpenClass:"open",backgroundClickClose:!0,escClose:!0},o=document.body,i=function(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]=arguments[e][t]);return arguments[0]},l=function(e,t){var s=e.className.split(" "),n=s.indexOf(t);n>-1&&s.splice(n,1),e.className=s.join(" ")},a=function(){this.modalCloseBtn.addEventListener("click",this.close),this.settings.escClose&&o.addEventListener("keyup",this._escCloseHandler),this.settings.backgroundClickClose&&this.modalOverlay.addEventListener("click",this.close)},d=function(){this.modalCloseBtn.removeEventListener("click",this.close),this.modalOverlay.removeEventListener("click",this.close),o.removeEventListener("keyup",this._escCloseHandler)},r=function(){this.onBeforeClose(this.modal),l(this.modal,this.settings.modalOpenClass),l(o,this.settings.bodyOpenClass),this._unbindClose()},m=function(e){27===e.keyCode&&this.close(),e.preventDefault()},h=function(){},c=function(){},u=function(){};return e.prototype.open=function(){this._bindClose(),setTimeout(function(){this.onBeforeOpen(this.modal),o.className+=" "+this.settings.bodyOpenClass,this.modal.className+=" "+this.settings.modalOpenClass,t=this}.bind(this),10)},s.create=function(t){return i(t,{openImmediately:!1}),new e(t)},s.open=function(t){return this.close(),i(t,{openImmediately:!0}),new e(t)},s.close=function(){t&&t.close(),t=null},s});