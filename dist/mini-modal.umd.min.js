!function(e,o){"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?module.exports=o():e.MiniModal=o()}(this,function(){"use strict";var e={},o={modalOverlayClass:"mini-modal__overlay",modalContentClass:"mini-modal__content",modalCloseBtnClass:"mini-modal__close",bodyOpenClass:"mini-modal-active",modalOpenClass:"mini-modal--open",backgroundClickClose:!0,escClose:!0,openImmediately:!1,moveToBodyEnd:!0,onInit:function(){},onBeforeOpen:function(){},onBeforeClose:function(){}},n={modalOverlay:"[data-mini-modal-overlay]",modalContent:"[data-mini-modal-content]",modalCloseBtn:"[data-mini-modal-close]"},l=function(){for(var e=1;e<arguments.length;e++)for(var o in arguments[e])arguments[e].hasOwnProperty(o)&&(arguments[0][o]=arguments[e][o]);return arguments[0]},a=document,t=void 0;return e.create=function(d,s){var i=l({},o,s),r={};if(!(r.modal=document.getElementById(d)))throw new Error('Element with id "'+d+'" not found.');r.modalOverlay=r.modal.querySelector(n.modalOverlay),r.modalContent=r.modal.querySelector(n.modalContent),r.modalCloseBtn=r.modal.querySelector(n.modalCloseBtn),r.modalOverlay.classList.add(i.modalOverlayClass),r.modalContent.classList.add(i.modalContentClass),r.modalCloseBtn.classList.add(i.modalCloseBtnClass);var c=function(){r.modalCloseBtn.addEventListener("click",f),i.escClose&&a.body.addEventListener("keyup",u),i.backgroundClickClose&&r.modalOverlay.addEventListener("click",f)},m=function(){r.modalCloseBtn.removeEventListener("click",f),r.modalOverlay.removeEventListener("click",f),a.body.removeEventListener("keyup",u)},u=function(e){27===e.keyCode&&f(),e.preventDefault()},C=function(){e.close(),c(),setTimeout(function(){i.onBeforeOpen.call(null,r),a.body.classList.add(i.bodyOpenClass),r.modal.classList.add(i.modalOpenClass),t=r},10)},f=function(){arguments[0]&&arguments[0].preventDefault&&arguments[0].preventDefault(),i.onBeforeClose.call(null,r)!==!1&&(r.modal.classList.remove(i.modalOpenClass),a.body.classList.remove(i.bodyOpenClass),m(),t=null)},v=function(e){switch(e){case"onInit":i.onInit.call(null,r);break;case"onBeforeOpen":i.onBeforeOpen.call(null,r);break;case"onBeforeClose":i.onBeforeClose.call(null,r)}};return i.onInit.call(null,r),i.moveToBodyEnd&&a.body.appendChild(r.modal),i.openImmediately&&C(),r.open=C,r.close=f,r.trigger=v,r.bindClose=c,r.unbindClose=m,r},e.close=function(){t&&t.close(),t=null},e.open=function(o,n){return e.close(),e.create(o,l(n||{},{openImmediately:!0}))},e.getActiveModal=function(){return t},e});